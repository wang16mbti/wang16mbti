<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>王老十六 | 设备连接</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        /* =========================================
           PART 1: 全局与 AirPods 弹窗样式 (iOS Style)
           ========================================= */
        body { margin: 0; padding: 0; height: 100vh; overflow: hidden; font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", sans-serif; background: #000; -webkit-user-select: none; user-select: none; }
        
        /* 弹窗层容器 */
        #airpods-layer {
            position: fixed; inset: 0; z-index: 9999;
            background: rgba(0,0,0,0.6); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
            display: flex; justify-content: center; align-items: flex-end;
            transition: opacity 0.5s ease;
        }

        /* 纯白卡片 */
        .ios-card {
            width: 94%; max-width: 400px; background: #fff;
            border-radius: 36px; padding: 40px 25px 30px 25px;
            box-sizing: border-box; margin-bottom: 20px; text-align: center;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            transform: translateY(120%);
            animation: springUp 0.8s cubic-bezier(0.19, 1, 0.22, 1) 0.2s forwards;
        }

        /* 旋转产品展示 */
        .product-hero {
            height: 160px; display: flex; justify-content: center; align-items: flex-end;
            margin-bottom: 25px; position: relative; perspective: 1000px;
        }
        /* 使用 image_0.png (人物) */
        .product-img {
            height: 100%; width: auto; object-fit: contain; z-index: 2;
            animation: floatAndSway 6s ease-in-out infinite;
            filter: drop-shadow(0 10px 20px rgba(0,0,0,0.2));
        }
        .shadow-platform {
            position: absolute; bottom: 10px; width: 80px; height: 20px;
            background: radial-gradient(ellipse at center, rgba(0,0,0,0.2) 0%, rgba(0,0,0,0) 70%);
            border-radius: 50%; z-index: 1; transform: scaleY(0.5);
            animation: shadowBreath 6s ease-in-out infinite;
        }

        /* iOS 控件 */
        h1.ios-title { font-size: 26px; font-weight: 600; margin: 0 0 5px 0; color: #000; }
        p.ios-sub { font-size: 14px; color: #86868b; margin: 0 0 25px 0; }
        
        .ios-input-group { background: #F2F2F7; border-radius: 12px; padding: 2px; margin-bottom: 12px; }
        .ios-select, .ios-input {
            width: 100%; background: transparent; border: none; padding: 14px;
            font-size: 16px; color: #000; outline: none; text-align: center; font-weight: 500;
        }

        .btn-connect {
            width: 100%; background: #007AFF; color: white; border: none; padding: 16px;
            border-radius: 14px; font-size: 16px; font-weight: 600; margin-top: 15px;
        }
        .btn-connect:active { background: #0063cc; transform: scale(0.98); }

        /* 动画定义 */
        @keyframes springUp { 0% { transform: translateY(100%); } 100% { transform: translateY(0); } }
        @keyframes floatAndSway { 0%,100% { transform: translateY(0) rotate(0deg); } 25% { transform: translateY(-8px) rotate(3deg); } 75% { transform: translateY(-8px) rotate(-3deg); } }
        @keyframes shadowBreath { 0%,100% { transform: scaleY(0.5) scaleX(1); opacity: 0.2; } 50% { transform: scaleY(0.5) scaleX(0.8); opacity: 0.1; } }

        /* =========================================
           PART 2: V23 游戏界面样式 (默认隐藏)
           ========================================= */
        #v23-app-layer {
            position: fixed; inset: 0; z-index: 1; display: none; opacity: 0; transition: opacity 0.8s ease;
            background: #fff; /* V23 基础背景 */
        }
        
        /* ... 这里保留 V23 的核心样式，做精简 ... */
        :root { --green: #00b894; --purple: #9c88ff; --yellow: #feca57; --blue: #0984e3; --active-color: #333; --rpg-theme: #333; }
        .hidden { display: none !important; }

        /* V23 首页 (Logo + 列表) */
        #select-page { 
            position: absolute; inset: 0; display: flex; flex-direction: column; padding: 20px; justify-content: center; align-items: center; 
            background: linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%);
        }
        .logo-img { max-width: 260px; height: auto; margin-bottom: 30px; filter: drop-shadow(0 5px 15px rgba(0,0,0,0.1)); }
        
        /* 列表容器 */
        .grid-wrapper { width: 100%; max-width: 400px; display: flex; flex-direction: column; gap: 12px; }
        .cat-row { padding: 12px; border-radius: 16px; border: 1px solid rgba(255,255,255,0.6); box-shadow: 0 2px 10px rgba(0,0,0,0.03); }
        .c-green { background: rgba(0,184,148,0.08); } .c-purple { background: rgba(156,136,255,0.08); } 
        .c-yellow { background: rgba(254,202,87,0.08); } .c-blue { background: rgba(9,132,227,0.08); }
        .cat-label { font-size: 13px; font-weight: 800; margin-bottom: 8px; color: #555; padding-left: 5px; }
        .btn-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px; }
        .detail-btn { height: 40px; border-radius: 10px; border: none; color: #fff; font-weight: bold; font-size: 13px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .c-green .detail-btn { background: var(--green); } .c-purple .detail-btn { background: var(--purple); }
        .c-yellow .detail-btn { background: var(--yellow); } .c-blue .detail-btn { background: var(--blue); }

        /* V23 个人档案弹窗 (Profile) */
        #profile-overlay { position: fixed; inset: 0; z-index: 2000; background: rgba(0,0,0,0.6); backdrop-filter: blur(5px); display: flex; justify-content: center; align-items: center; }
        .profile-card { width: 300px; background: #fff; border-radius: 20px; position: relative; overflow: visible; animation: popUp 0.3s ease-out; }
        .pc-header { height: 90px; border-radius: 20px 20px 0 0; background: #eee; position: relative; }
        
        /* 头像 (手办图) */
        .pc-avatar-box { position: absolute; bottom: -20px; left: 20px; filter: drop-shadow(0 8px 15px rgba(0,0,0,0.2)); }
        .avatar-img { width: 120px; height: auto; animation: floatAvatar 4s ease-in-out infinite; }
        @keyframes floatAvatar { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-8px)} }
        
        .pc-type { position: absolute; bottom: 10px; right: 20px; font-size: 30px; font-weight: 900; color: #fff; opacity: 0.9; }
        .pc-body { padding: 40px 20px 20px 20px; min-height: 200px; }
        .pc-row { margin-bottom: 12px; } .pc-l { font-size: 12px; color: #999; font-weight: bold; } .pc-v { font-size: 14px; font-weight: bold; color: #333; }
        .close-pc { position: absolute; top: 15px; right: 15px; color: rgba(255,255,255,0.8); font-size: 20px; }
        
        @keyframes popUp { from{transform:scale(0.9);opacity:0} to{transform:scale(1);opacity:1} }

    </style>
</head>
<body>

    <div id="airpods-layer">
        <div class="ios-card">
            <div class="product-hero">
                <img src="image_0.png" class="product-img" alt="Figure">
                <div class="shadow-platform"></div>
            </div>

            <div id="connect-ui">
                <h1 class="ios-title">王老十六</h1>
                <p class="ios-sub">请求建立神经连接</p>
                
                <div class="ios-input-group">
                    <select id="start-mbti" class="ios-select">
                        <option value="" disabled selected>选择你的 MBTI 核心</option>
                        <option value="INTJ">INTJ</option> <option value="INTP">INTP</option>
                        <option value="ENTJ">ENTJ</option> <option value="ENTP">ENTP</option>
                        <option value="INFJ">INFJ</option> <option value="INFP">INFP</option>
                        <option value="ENFJ">ENFJ</option> <option value="ENFP">ENFP</option>
                        <option value="ISTJ">ISTJ</option> <option value="ISFJ">ISFJ</option>
                        <option value="ESTJ">ESTJ</option> <option value="ESFJ">ESFJ</option>
                        <option value="ISTP">ISTP</option> <option value="ISFP">ISFP</option>
                        <option value="ESTP">ESTP</option> <option value="ESFP">ESFP</option>
                    </select>
                </div>
                <button class="btn-connect" onclick="enterWorld()">允许连接</button>
            </div>

            <div id="loading-ui" style="display:none; padding: 20px;">
                <i class="fa-solid fa-circle-notch fa-spin" style="font-size:24px; color:#86868b;"></i>
                <p class="ios-sub" style="margin-top:10px;">正在同步数据...</p>
            </div>
        </div>
    </div>

    <div id="v23-app-layer">
        
        <div id="select-page">
            <img src="image_1.png" class="logo-img" alt="Logo">
            
            <div class="grid-wrapper">
                <div class="cat-row c-green"><div class="cat-label">理想主义 (NF)</div><div class="btn-grid"><button class="detail-btn" onclick="showProfile('INFP','green')">INFP</button><button class="detail-btn" onclick="showProfile('INFJ','green')">INFJ</button><button class="detail-btn" onclick="showProfile('ENFP','green')">ENFP</button><button class="detail-btn" onclick="showProfile('ENFJ','green')">ENFJ</button></div></div>
                <div class="cat-row c-purple"><div class="cat-label">理性分析 (NT)</div><div class="btn-grid"><button class="detail-btn" onclick="showProfile('INTJ','purple')">INTJ</button><button class="detail-btn" onclick="showProfile('INTP','purple')">INTP</button><button class="detail-btn" onclick="showProfile('ENTJ','purple')">ENTJ</button><button class="detail-btn" onclick="showProfile('ENTP','purple')">ENTP</button></div></div>
                <div class="cat-row c-yellow"><div class="cat-label">自由探险 (SP)</div><div class="btn-grid"><button class="detail-btn" onclick="showProfile('ISTP','yellow')">ISTP</button><button class="detail-btn" onclick="showProfile('ISFP','yellow')">ISFP</button><button class="detail-btn" onclick="showProfile('ESTP','yellow')">ESTP</button><button class="detail-btn" onclick="showProfile('ESFP','yellow')">ESFP</button></div></div>
                <div class="cat-row c-blue"><div class="cat-label">忠诚守护 (SJ)</div><div class="btn-grid"><button class="detail-btn" onclick="showProfile('ISTJ','blue')">ISTJ</button><button class="detail-btn" onclick="showProfile('ISFJ','blue')">ISFJ</button><button class="detail-btn" onclick="showProfile('ESTJ','blue')">ESTJ</button><button class="detail-btn" onclick="showProfile('ESFJ','blue')">ESFJ</button></div></div>
            </div>
            
            <div style="margin-top:30px;font-size:12px;color:#ccc;font-weight:bold;">王老十六 © WANG16 MBTI</div>
        </div>

        <div id="profile-overlay" class="hidden" onclick="closeProfile(event)">
            <div class="profile-card" onclick="event.stopPropagation()">
                <div class="pc-header" id="pcHeader">
                    <i class="fa-solid fa-xmark close-pc" onclick="closeProfile()"></i>
                    <div class="pc-type" id="pcTitle">INTJ</div>
                </div>
                
                <div class="pc-avatar-box" id="pcAvatarContainer">
                    </div>

                <div class="pc-body">
                    <div class="pc-row"><span class="pc-l">核心关键词</span><div class="pc-v" id="pcTags">...</div></div>
                    <div class="pc-row"><span class="pc-l">灵魂共鸣</span><div class="pc-v" id="pcRes">...</div></div>
                    <div class="pc-row"><span class="pc-l">天选职业</span><div class="pc-v" id="pcJob">...</div></div>
                </div>
            </div>
        </div>

    </div>

    <script>
        // --- 全局变量 ---
        const typeColors = { 
            green: {main:'#00b894', bg:'#e6fcf5'}, purple: {main:'#9c88ff', bg:'#f3f0ff'}, 
            yellow: {main:'#feca57', bg:'#fffbf0'}, blue: {main:'#0984e3', bg:'#e7f5ff'} 
        };
        const profileDB = {
            "green": { tags:"理想主义 / 治愈", res:"世界吻我以痛，我却报之以歌。", job:"作家, 咨询师" },
            "purple": { tags:"逻辑 / 独立 / 战略", res:"真理掌握在少数人手中。", job:"科学家, 投资人" },
            "yellow": { tags:"自由 / 冒险 / 乐天", res:"人生苦短，及时行乐。", job:"赛车手, 演员" },
            "blue": { tags:"秩序 / 靠谱 / 守护", res:"平平淡淡才是真。", job:"公务员, 医生" }
        };

        // --- 核心逻辑 1: 处理 AirPods 连接 ---
        function enterWorld() {
            const mbti = document.getElementById('start-mbti').value;
            if(!mbti) { alert("请先选择你的 MBTI"); return; }

            // 1. 切换到 Loading 状态
            document.getElementById('connect-ui').style.display = 'none';
            document.getElementById('loading-ui').style.display = 'block';

            // 2. 模拟延迟 + 切换层级
            setTimeout(() => {
                // 隐藏 AirPods 层
                const airLayer = document.getElementById('airpods-layer');
                airLayer.style.opacity = '0';
                
                // 显示 V23 游戏层
                const appLayer = document.getElementById('v23-app-layer');
                appLayer.style.display = 'block';
                // 强制重绘
                void appLayer.offsetWidth;
                appLayer.style.opacity = '1';

                // 移除 AirPods 层 (可选)
                setTimeout(() => { airLayer.style.display = 'none'; }, 500);

            }, 1500);
        }

        // --- 核心逻辑 2: V23 显示档案 ---
        function showProfile(type, colorKey) {
            const d = profileDB[colorKey];
            const color = typeColors[colorKey].main;
            
            document.getElementById('profile-overlay').classList.remove('hidden');
            document.getElementById('pcTitle').innerText = type;
            document.getElementById('pcHeader').style.background = color;
            document.getElementById('pcTags').innerText = d.tags;
            document.getElementById('pcRes').innerText = d.res;
            document.getElementById('pcJob').innerText = d.job;

            // 处理头像：如果是 INTJ (或其他你想要的)，显示手办图
            const avatarBox = document.getElementById('pcAvatarContainer');
            // 这里为了演示，所有类型都显示手办图（你可以加 if 判断）
            avatarBox.innerHTML = '<img src="image_0.png" class="avatar-img" alt="Avatar">';
        }

        function closeProfile(e) {
            if(!e || e.target.id === 'profile-overlay' || e.target.classList.contains('close-pc')) {
                document.getElementById('profile-overlay').classList.add('hidden');
            }
        }
    </script>
</body>
</html>
